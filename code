//pins
const int GAS_SENSOR= A1;
const int TEMP =A0;
const int BUZZER= 10;
const int SWITCH=2;
const int LED=13;

float TEMP_THRESH=207;
float GAS_THRESH=250;

int lastSwitchState;

bool alarmIsActive;

void setup()
{
  pinMode(13, OUTPUT);
  pinMode(BUZZER,OUTPUT);
  
  Serial.begin(9600);
  
  lastSwitchState = digitalRead(SWITCH);

}

void loop()
{
  int currentSwitchState = digitalRead(SWITCH);

  int tempValue=analogRead(TEMP);
  int gasValue=analogRead(GAS_SENSOR);
  
  if(tempValue>TEMP_THRESH || gasValue>GAS_THRESH)
  {
    alarmIsActive=true;  	
  }
  
  if(currentSwitchState != lastSwitchState) 
  	{
      alarmIsActive=false;
      Serial.println("Alarm OFF");
  	}
  
  if(alarmIsActive==true){
    AlarmON();
    Serial.println("Alarm ON");
  }else if (alarmIsActive==false){
    AlarmOFF();
    Serial.println("Alarm OFF");
  }
  
  
  lastSwitchState = currentSwitchState;
  
  Serial.print("Current gas value: ");
  Serial.println(gasValue);
  Serial.print("Current temp value: ");
  Serial.println(tempValue);
}


//Alarm functions
void AlarmON(){
  
  //1st flash
  digitalWrite(LED,HIGH);
  digitalWrite(BUZZER, HIGH);
  delay(200);
  digitalWrite(LED,LOW);
  digitalWrite(BUZZER, LOW);
  delay (150);
  
  //2nd flash
  digitalWrite(LED,HIGH);
  digitalWrite(BUZZER, HIGH);
  delay(200);
  digitalWrite(LED,LOW);
  digitalWrite(BUZZER, LOW);
  delay (150);
  
  //wait
  delay(600);
}

void AlarmOFF(){
  digitalWrite(LED,LOW);
  digitalWrite(BUZZER,LOW);
}


